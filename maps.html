<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Guides MU-HARDCORE</title>

    <!-- jQuery vor dem Skript laden -->
    <script src="js/jquery.min.js"></script>
    <!-- Nur die CDN-Version von Bootstrap verwenden -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/aos.js"></script>
    <script src="js/smoothscroll.js"></script>
    <script src="js/custom.js"></script>

    <style>
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .highlight-text {
            color: #f1c40f;
            font-weight: bold;
        }

        @media screen and (max-width: 768px) {
            .map-image {
                width: 80%;
                max-width: 250px;
                height: auto;
            }

            .map-container {
                flex-direction: column;
            }
        }
    </style>
</head>

<body oncopy="return false" oncut="return false" onpaste="return false" data-spy="scroll" data-target="#navbarNav"
    data-offset="50">
    <div class="loader">Loading...</div>

    <div id="navbar-container"></div>

    <section class="about section" id="about">
        <div style="max-width: 1200px; margin: 0 auto; padding: 20px;">
            <h1 style="text-align: center;">üó∫Ô∏è MAPS & MONSTERS</h1>
            <br>
            <div class="summary-container">
                <!-- Information ist standardm√§√üig ge√∂ffnet -->
                <details class="details-box" open onclick="showContent('info')">
                    <summary>Information</summary>
                </details>
            </div><br>
            <!-- Alle Details-Buttons bleiben oben -->
            <div class="summary-container">
                <details class="details-box" id="lorencia-details" onclick="showContent('lorencia')">
                    <summary>Lorencia</summary>
                </details>
                <details class="details-box" onclick="showContent('noria')">
                    <summary>Noria</summary>
                </details>
                <details class="details-box" onclick="showContent('devias')">
                    <summary>Devias</summary>
                </details>
                <details class="details-box" onclick="showContent('dungeon')">
                    <summary>Dungeon</summary>
                </details>
                <details class="details-box" onclick="showContent('atlans')">
                    <summary>Atlans</summary>
                </details>
                <details class="details-box" onclick="showContent('tarkan')">
                    <summary>Tarkan</summary>
                </details>
                <details class="details-box" onclick="showContent('aida')">
                    <summary>Aida</summary>
                </details>
                <details class="details-box" onclick="showContent('kalima')">
                    <summary>Kalima</summary>
                </details>
                <details class="details-box" onclick="showContent('icarus')">
                    <summary>Icarus</summary>
                </details>
                <details class="details-box" onclick="showContent('kantururuins')">
                    <summary>Kanturu Ruins</summary>
                </details><br>
                <details class="details-box" onclick="showContent('kanturuunderground')">
                    <summary>Kanturu Underground</summary>
                </details>
                <details class="details-box" onclick="showContent('kantururelics')">
                    <summary>Kanturu Relics</summary>
                </details>
                <details class="details-box" onclick="showContent('raklion')">
                    <summary>Raklion</summary>
                </details>
                <details class="details-box" onclick="showContent('crywolf')">
                    <summary>Crywolf</summary>
                </details>
                <details class="details-box" onclick="showContent('baraks')">
                    <summary>Barraks of Balgas</summary>
                </details>
                <details class="details-box" onclick="showContent('karutan')">
                    <summary>Karutan</summary>
                </details>
                <details class="details-box" onclick="showContent('swamp')">
                    <summary>Swamp of Peace</summary>
                </details>
                <details class="details-box" onclick="showContent('grayaida')">
                    <summary>Gray Aida</summary>
                </details>
                <details class="details-box" onclick="showContent('nixis')">
                    <summary>Nixies Lake</summary>
                </details>
                <details class="details-box" onclick="showContent('ferea')">
                    <summary>Ferea</summary>
                </details>
                <details class="details-box" onclick="showContent('deep')">
                    <summary>Deep Dungeon</summary>
                </details>
                <details class="details-box" onclick="showContent('swampofdarkness')">
                    <summary>Swamp of Darkness</summary>
                </details>
                <details class="details-box" onclick="showContent('atlansabbys')">
                    <summary>Atlans Abbys</summary>
                </details>
            </div>
            <div id="content" class="content-container"></div>
        </div>
    </section>

    <div id="footer-container"></div>
    <!-- jQuery laden -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Schutz-Skript -->
    <!-- <script src="js/protection.js"></script> -->
    <script>
        // jQuery-Skript f√ºr Cut/Copy/Paste und Rechtsklick deaktivieren
        $(document).ready(function () {
            $('body').bind('cut copy paste', function (e) {
                e.preventDefault();
            });

            $("body").on("contextmenu", function (e) {
                return false;
            });
        });

        // Laden der externen Dateien und Initialisierung
        document.addEventListener("DOMContentLoaded", function () {
            const loader = document.querySelector('.loader');

            fetch('libraries.html?v=' + new Date().getTime())
                .then(response => response.text())
                .then(data => {
                    document.head.insertAdjacentHTML('beforeend', data);
                    return fetch('navbar.html?v=' + new Date().getTime());
                })
                .then(response => response.text())
                .then(data => {
                    document.getElementById('navbar-container').innerHTML = data;
                    return fetch('footer.html?v=' + new Date().getTime());
                })
                .then(response => response.text())
                .then(data => {
                    document.getElementById('footer-container').innerHTML = data;
                    // Seite √∂ffnet standardm√§√üig auf "info"
                    // showContent('info');
                })
                .catch(error => {
                    console.error('Fehler beim Laden:', error);
                    loader.style.display = 'none';
                });
        });

        // Funktion zum Anzeigen der Inhalte basierend auf der Region
        function showContent(region, pushState = true) {
            const content = document.getElementById("content");
            const loader = document.querySelector('.loader');

            // Ladeanzeige einblenden
            loader.style.display = 'block';
            content.innerHTML = '';

            if (region === 'info') {
                // Statischer HTML-Inhalt f√ºr den Info-Abschnitt
                let html = `
                    <div class="main-container">
                        <h1 class="main-title">Information</h1>
                        <p style="color: #f1c40f;">In this chapter, you can read the specific information about the available locations on our server, such as monster level,hp,defence,etc. </p>
                    </div>
                `;

                content.innerHTML = html;
                loader.style.display = 'none'; // Ladeanzeige ausblenden

                finalizeContentState(region, pushState);
            } else {
                // Lade die Map-Daten aus monsters.json
                fetch('configs/monsters.json')
                    .then(response => response.json())
                    .then(data => {
                        const regionData = data[region];
                        if (!regionData || !regionData.monsters || regionData.monsters.length === 0) {
                            content.innerHTML = `<p>Keine Daten f√ºr ${region} gefunden.</p>`;
                            loader.style.display = 'none';
                            finalizeContentState(region, pushState);
                            return;
                        }

                        let html = `
                            <div class="main-container">
                                <h1 class="main-title">${region.charAt(0).toUpperCase() + region.slice(1)}</h1>
                                <div class="map-container" style="display: flex; align-items: center; gap: 20px;">
                                    <div class="map-image-container" style="flex: 1;">
                                        <img src="${regionData.map}" alt="${region} Map Image" class="map-image" style="width: 500px; height: auto;">
                                    </div>
                                    <div class="map-text-content" style="flex: 2; color: #f1c40f; font-size: 16px; font-family: Arial, sans-serif;">
                                        <div class="map-description">${regionData.description}</div>
                                    </div>
                                </div><br><br>
                        `;

                        regionData.monsters.forEach(monster => {
                            html += `
                                <div class="item-wrapper">
                                    <p style="line-height:140%; text-align:center;">
                                        <span style="color:#49e410; line-height:19.6px;">
                                            <strong style="vertical-align: middle; margin-bottom: 12px; display: inline-block;">${monster.name}</strong><br>
                                            <img src="${monster.image}" alt="${monster.name}" class="item-thumb" style=" width: 120px; height: 120px;">
                                        </span><br>
                                    </p>
                                    <div class="popup-info" style="width: 200px;">
                                        <div class="popup-header">${monster.name}</div>
                                        <img src="${monster.image}" alt="${monster.name}" class="popup-im" style="vertical-align: middle; width: 120px; height: 120px;">
                                        <br>
                                        <div class="popup-name" style="display: inline;font-size: 18px; font-weight: bold;">Monster level :</div>
                                        <div class="popup-loot" style="display: inline;font-size: 18px;">${monster.level}</div><br>
                                        <div class="popup-name" style="display: inline;font-size: 18px; font-weight: bold;">HP :</div>
                                        <div class="popup-loot" style="display: inline;font-size: 18px;">${monster.hp}</div><br>
                                        <div class="popup-name" style="display: inline;font-size: 18px; font-weight: bold;">DEFENSE :</div>
                                        <div class="popup-loot" style="display: inline;font-size: 18px;">${monster.defense}</div><br>
                                        <div class="popup-name" style="display: inline;font-size: 18px; font-weight: bold;">DMG :</div>
                                        <div class="popup-loot" style="display: inline;font-size: 18px;">${monster.damage}</div>
                                    </div>
                                </div>
                            `;
                        });

                        html += '</div>';
                        content.innerHTML = html;
                        loader.style.display = 'none'; // Ladeanzeige ausblenden

                        finalizeContentState(region, pushState);

                    })
                    .catch(error => {
                        console.error('Fehler beim Laden von monsters.json:', error);
                        content.innerHTML = `<p>Fehler beim Laden der Daten.</p>`;
                        loader.style.display = 'none';


                        finalizeContentState(region, pushState);
                    });
            }
        }


        window.addEventListener('popstate', function (event) {
            const region = event.state?.region || 'info';
            showContent(region, false); // Don't push again
        });


        function finalizeContentState(region, pushState = true) {
            // ‚úÖ Remove open from all
            document.querySelectorAll('details.details-box').forEach(d => d.removeAttribute('open'));

            // ‚úÖ Find the matching one and set open
            const matchingDetails = Array.from(document.querySelectorAll('details.details-box')).find(d => {
                const onclickAttr = d.getAttribute('onclick') || "";
                const cleanAttr = onclickAttr.replace(/\s/g, '').replace(/"/g, "'");
                return cleanAttr === `showContent('${region}')`;
            });

            console.log("Matching <details>:", matchingDetails);

            if (matchingDetails) {
                setTimeout(() => {
                    matchingDetails.setAttribute('open', 'true');
                }, 0);
            }

            // ‚úÖ Update URL without reload
            if (pushState) {
                const newUrl = `${window.location.pathname}?q=${encodeURIComponent(region)}`;
                history.pushState({ region }, '', newUrl);
            }
        }

    </script>





    <script>
        function autoDetectSection(query) {
            query = query.toLowerCase();
            const sectionIdMap = {
                "information": "info",
                "lorencia": "lorencia",
                "noria": "noria",
                "devias": "devias",
                "dungeon": "dungeon",
                "atlans": "atlans",
                "tarkan": "tarkan",
                "aida": "aida",
                "kalima": "kalima",
                "icarus": "icarus",
                "kanturu ruins": "kantururuins",
                "kanturu underground": "kanturuunderground",
                "kanturu relics": "kantururelics",
                "raklion": "raklion",
                "crywolf": "crywolf",
                "barraks of balgas": "baraks",
                "karutan": "karutan",
                "swamp of peace": "swamp",
                "gray aida": "grayaida",
                "nixies lake": "nixis",
                "ferea": "ferea",
                "deep dungeon": "deep",
                "swamp of darkness": "swampofdarkness",
                "atlans abbys": "atlansabbys"

            };

            // ‚úÖ NEW: if query is a section ID directly
            if (Object.values(sectionIdMap).includes(query)) {
                console.log(`Direct section ID match: ${query}`);
                return query;
            }

            for (const tag in sectionIdMap) {
                if (query.includes(tag)) {
                    console.log(`Matched query "${query}" ‚Üí section: ${sectionIdMap[tag]}`);
                    return sectionIdMap[tag];
                }
            }

            console.warn("No matching section found, defaulting to 'info'");
            return 'info';
        }


        document.addEventListener("DOMContentLoaded", function () {
            const params = new URLSearchParams(window.location.search);
            const q = params.get("q") || "info";
            console.log("Query param received:", q);
            const section = autoDetectSection(q);
            showContent(section, false);


        });

    </script>
</body>

</html>